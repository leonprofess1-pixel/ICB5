# Role
- 너는 시니어 데이터 분석가야.
- 제공된 `./data/olist_merged_dataset_deduped.csv` 데이터를 활용하여, kpi_tree_detailed_design.md 문서 바탕으로 설계한 KPI Tree 지표들을 실제로 산출하고 주차별 트렌드 데이터프레임을 생성하는 것이 이번 태스크의 목표야.

# Objective
설계된 KPI Tree의 각 노드(Level 0 ~ Level 4)를 실제 데이터 컬럼과 매핑하여 계산하고, 이를 '주차(Weekly)' 단위로 집계하여 하나의 통합된 데이터프레임 파일로 저장해줘.

# Analysis Steps
1. **Metric Mapping & Calculation**: 
   - `payment_value_sum`을 최상위 지표(Level 0)로 설정.
   - 하위 지표들을 데이터셋 내 컬럼(order_id, customer_id, product_id, price, freight_value, order_purchase_timestamp 등)을 활용해 산출 로직을 생성할 것.
   - 예: 주문 건수(Count of order_id), 객단가(Sum of payment / Count of order_id) 등.

2. **Time-series Aggregation**:
   - `order_purchase_timestamp`를 기준으로 '주차(Week)' 컬럼을 생성.
   - 모든 KPI 지표를 주차별로 Aggregation 할 것.

3. **Data Quality Check**:
   - 지표 산출 시 결측치는 0으로 처리하거나 적절한 방식으로 핸들링하여 트렌드 흐름이 깨지지 않게 할 것.
   - 산술적 인과관계(상위 지표 = 하위 지표들의 합 또는 곱)가 데이터프레임 내에서도 유지되는지 검증할 것.

# Output Requirements
- **Output File**: 모든 주차별 지표가 포함된 단일 CSV 파일 생성 (`kpi-tree/weekly_kpi_trend_analysis.csv`).
- **Data Structure**: 
    - Columns: `week_start_date`, `level0_metric`, `level1_metric_a`, `level1_metric_b`, ..., `level4_metric_n`
    - 각 지표명은 KPI Tree에서 정의한 이름을 사용할 것.
- **Python Code**: 위 작업을 수행하기 위한 전체 Python 코드를 코드 블록으로 제공할 것.

# Constraints
- 모든 코드는 효율적이고 가독성이 좋아야 함 (Pandas Method Chaining 권장).
- 결과 파일은 반드시 `kpi-tree/` 폴더 안에 저장할 것.